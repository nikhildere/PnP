<?xml version="1.0" encoding="utf-8" ?>
<pnp:ProvisioningTemplate ID="Mdlz.EnterpriseWikiSite" Version="1.0"
  xmlns:pnp="http://schemas.dev.office.com/PnP/2015/05/ProvisioningSchema"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <pnp:CustomActions>
    <pnp:SiteCustomActions>
      <pnp:CustomAction Name="CA_SITE_SUBSITE_OVERRIDE"
                Description="Override new sub-site link"
                Location="ScriptLink"
                Title="CA_SITE_SUBSITE_OVERRIDE"
                ScriptSrc=""
                ScriptBlock="
                    var SubSiteSettings_Web_Url = 'https://[RemoteWebHostNameToken]/pages/subsite/newsbweb.aspx?SPHostUrl=';
                    var headID = document.getElementsByTagName('head')[0]; 
                    var subsiteScriptTag = document.createElement('script');
                    subsiteScriptTag.type = 'text/javascript';
                    subsiteScriptTag.src = '/SiteAssets/Common/ProvApp/scripts/SubSiteOverride.js';
                    headID.appendChild(subsiteScriptTag);"/>
    </pnp:SiteCustomActions>
    <pnp:WebCustomActions>
      <pnp:CustomAction Name="CA_SITE_SETTINGS_SITECLASSIFICATION"
                Description="Site Classification Application"
                Group="SiteTasks"
                Location="Microsoft.SharePoint.SiteSettings"
                Title="Site Classification"
                Sequence="1000"
                Url="https://[RemoteWebHostNameToken]/pages/SiteClassification/SiteEdit.aspx?SPHostUrl={0}"
                Rights="31"/>
      <pnp:CustomAction Name="CA_SITE_STDMENU_SITECLASSIFICATION"
                Description="Site Classification Module"
                Group="SiteActions"
                Location="Microsoft.SharePoint.StandardMenu"
                Title="Site Classification"
                Sequence="1000"
                Url="https://[RemoteWebHostNameToken]/pages/SiteClassification/SiteEdit.aspx?SPHostUrl={0}"
                Rights="31"/>
      <pnp:CustomAction Name="MondelezJsInjections_e22a344d-3e37-4593-b643-17b99e0b459e"
                Description="Mondelez Js Injections"
                Group="SiteActions"
                Location="ScriptLink"
                Title="Mondelez Js Injections"
                Sequence="1000"
                ScriptBlock="var nl = new Date();
                             var nlu = new Date(nl.getTime() + nl.getTimezoneOffset() * 60000);
                             var onejan = new Date(nlu.getFullYear(), 0, 1);
                             var verStr = Math.ceil( (((nlu - onejan) / 86400000) + onejan.getDay() + 1) / 7 ).toString() + nl.getFullYear().toString();
                             var scr_elem = document.createElement('script');
                             scr_elem.type = 'text/javascript';
                             scr_elem.src = '/SiteAssets/Wiki/scripts/MDLZWikisite.Init.js' + '?rev=' + verStr;
                             var headElem = document.getElementsByTagName('head')[0];
                             headElem.appendChild(scr_elem);"/>
    </pnp:WebCustomActions>
  </pnp:CustomActions>
  <pnp:ComposedLook Name="Office"
                    AlternateCSS="/SiteAssets/Wiki/Css/MDLZWikiSite.css"
                    SiteLogo="/SiteAssets/Common/images/MDLZSiteIcon.png" 
                    ColorFile="" FontFile="" BackgroundFile=""/>
  <pnp:Providers>
    <pnp:Provider HandlerType="Provisioning.Job.MdlzComponents.ExtensibilityProviders.MdlzWikiSiteExtensibilityProvider, Provisioning.Job" Enabled="true">
    </pnp:Provider>
  </pnp:Providers>
</pnp:ProvisioningTemplate>
